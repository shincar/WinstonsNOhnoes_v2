<!DOCTYPE html>
<html>
  <head>
  <title>Adam & Alvin's Lab - Winston & Ohnoes</title>
  <style>
  body {
    margin: 0px;
    padding: 0px;
  }
  canvas {
    outline: 0px;
    position: absolute;
    margin: 0px;
    padding: 0px;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }
  </style>
  <script src="js/processing-1.4.8.js"></script>
  <script type="text/processing" data-processing-target="processing-canvas">
  /* @pjs preload="images/cs-winston.png,images/cs-ohnoes.png"; */

  const GAME_SCENE_HOME = 0;
  const GAME_SCENE_PLAYGROUND = 1;
  const GAME_SCENE_END = 2;

  const TOKEN_SIZE_SMALL = 40;
  const TOKEN_SIZE_MEDIUM = 70;
  const TOKEN_SIZE_LARGE = 100;

  var gridSize = 160;
  var gridCount = 3;
  var paddingOfBoard = 120;
  var maxSize = gridSize * gridCount + paddingOfBoard * 2;
  var paddingExtraH = (window.innerWidth - maxSize) / 2;
  var paddingExtraV = (window.innerHeight - maxSize) / 2;
  size(window.innerWidth, window.innerHeight);

  var Grid = function(x, y, size) {
        this.x = x;
        this.y = y;
        this.size = size;
        this.token_list = [];
        this.owner = 0;
  };

  var PlayGround = function() {
    this.grid_count = gridCount * gridCount;
    this.grid_size = gridSize;
    this.padding = paddingOfBoard;
    this.gridList = [];
    this.lines = [];
    this.winner = 0;

    for(var row = 0; row < gridCount; row++) {
        for(var col = 0; col < gridCount; col++) {
            this.gridList.push(new Grid(this.padding + (col + 0.5) * this.grid_size + paddingExtraH, this.padding + (row + 0.5) * this.grid_size + paddingExtraV, this.grid_size));
        }
    }
  };

  var Token = function(id, size, color, image) {
    this.player_id = id;
    this.size = size;
    this.color = color;
    this.image = image;
    this.selected = false;
    this.used = false;
    this.visible = true;
    this.currentX = 0;
    this.currentY = 0;
    this.currentSize = 0;
    this.parentGrid;
  };

  var Player = function(id, name, color, image) {
    this.id = id;
    this.name = name;
    this.color = color;
    this.image = image;
    this.tokens = [new Token(id, TOKEN_SIZE_SMALL, color, image), new Token(id, TOKEN_SIZE_SMALL, color, image),
                   new Token(id, TOKEN_SIZE_MEDIUM, color, image), new Token(id, TOKEN_SIZE_MEDIUM, color, image),
                   new Token(id, TOKEN_SIZE_LARGE, color, image), new Token(id, TOKEN_SIZE_LARGE, color, image)];
  };

  var Button = function(text, x, y, w, h, radius) {
    this.text = text;
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;
    this.radius = radius;
    this.color = color(93,194,83);
    this.text_color = color(213,251,209);
    this.stroke_color = color(213,251,209);
    this.stroke_weight = 5;
    this.text_size = 36;
  };

  var player1 = new Player(1, "Player 1", color(213,251,209), loadImage("images/cs-winston.png"));
  var player2 = new Player(2, "Player 2", color(58,121,52), loadImage("images/cs-ohnoes.png"));
  var start_button = new Button("Start", paddingOfBoard + 30 + paddingExtraH, gridSize * 2 + paddingOfBoard + paddingExtraV, gridSize, gridSize * 0.3, gridSize / 10);
  var options_button = new Button("Back", maxSize + paddingExtraH - (paddingOfBoard + 30) - gridSize, gridSize * 2 + paddingOfBoard + paddingExtraV, gridSize, gridSize * 0.3, gridSize / 10);

  var playground = new PlayGround();

  var stepCounter = 0;
  var players = [player1, player2];

  var drawHomeScene = function() {
      background(58,121,52);
      fill(213,251,209);
      textSize(60);
      textAlign(CENTER,CENTER);
      text("Winston & Ohnoes", 0, 0, maxSize + 2 * paddingExtraH, maxSize * 0.75 + 2 * paddingExtraV);

      // Draw start button
      start_button.draw();
      options_button.draw();

      image(player1.image, paddingOfBoard + 50 + paddingExtraH, paddingOfBoard + paddingExtraV, 100, 100);
      image(player2.image, maxSize - paddingOfBoard - 150 + paddingExtraH, paddingOfBoard + paddingExtraV, 100, 100);
  };

  var gameScene = GAME_SCENE_HOME;
  var image_left = paddingExtraH;
  var image_step = 2;

  drawHomeScence();
  </script>
  </head>
  <body>
  <div class="canvas_div" align="center" >
  <canvas id="processing-canvas"></canvas>
  </div>
  </body>
</html>
